# Copilot / AI Agent Instructions for Hugo Theme "Chirpy"

Purpose
- Short, actionable facts to quickly get an AI agent productive in this repo.

Quick facts (what matters most) âœ…
- This is a Hugo theme (Chirpy). The demo site lives in `exampleSite/` and uses `themesDir = "../../"` so the theme is mounted from the repo root.
- Hugo Extended (SASS support) is required to build SCSS under `assets/scss/` (the theme uses Hugo Pipes for SASS).
- Search index is generated by `layouts/_default/index.json` (used by the theme's built-in search).
- Third-party JS/CSS mappings are managed under `data/origin/*.yaml` (e.g., `cors.yaml`, `basic.yaml`).

Local dev / preview (exact commands) âš™ï¸
- Preview the theme with the example site (recommended):
  - cd repo root and run: `hugo server -s exampleSite -D`  # `-D` includes drafts; use `--environment production` for prod settings
- Build for production: `hugo -s exampleSite --environment production` or run on CI with the Hugo binary that supports modules/extended features.
- If SASS or assets do not compile: ensure you have "Hugo Extended" (the one with SASS/Dart Sass support).

Project structure & why it matters ğŸ”
- assets/
  - `assets/scss/` â€” central SCSS architecture (abstracts/_variables.scss, main.bundle.scss). SCSS is compiled via Hugo Pipes.
  - `assets/js/modules/` â€” modular JS (components related to UI features). Use these when tracing JS behavior.
- layouts/ and partials/ â€” primary template logic. Look at `layouts/partials/sidebar.html` for site `params` usage and `layouts/_default/index.json` for how pages are indexed for search.
- i18n/ â€” translations keys (one file per language). ExampleSite shows localized content (en and zh-CN).

Conventions & patterns to follow ğŸ’¡
- Do not make UI-only changes in `exampleSite/` unless they are specifically demo changes â€” it's the example, not the source theme. Keep theme changes in top-level `assets/` and `layouts/`.
- Site-level params are read in templates as `.Site.Params` (see `layouts/partials/sidebar.html` and analytics partials). Use those to toggle features (analytics, PWA, themeMode, etc.).
- Use `resources.Get` and Hugo resources pipeline when referencing images and compiled assets.

Integration points / notable files ğŸ”—
- `hugo.toml` (root) â€” theme-level params and module references.
- `go.mod` â€” Hugo modules used by the theme (means Hugo modules will be fetched on build).
- `data/origin/*.yaml` â€” configure CDN/third-party assets (mermaid, MathJax, dayjs, etc.).
- `layouts/_default/index.json` â€” search index generation logic (update this if adding fields to the index).
- `assets/js/pwa/` â€” PWA scripts (app.js, sw.js) and `assets/img/favicons/site.webmanifest` for manifest.

Testing & validation notes ğŸ§ª
- There are no automated tests in the repo; validation is functional/visual: run `hugo server -s exampleSite -D` and verify compiled CSS/JS, pages, and `/index.json`.
- To verify "last modified" values, ensure `enableGitInfo = true` is set in `exampleSite/hugo.toml`.

PR tips for contributors âœï¸
- Explain visual changes with screenshots and the Hugo command used to preview.
- When changing the search indexing, include a short description of new fields and an example `index.json` snippet.
- If SCSS variables change, point to `assets/scss/abstracts/_variables.scss` and show resulting visual diffs (dark vs light theme behavior).

Examples (quick references) ğŸ”
- Where search index is built: `layouts/_default/index.json` (look for `$.Scratch.Add "index" (dict "title" .Title ...)`).
- Where external JS libs are defined: `data/origin/cors.yaml` and `data/origin/basic.yaml`.
- Main SCSS entry: `assets/scss/main.bundle.scss`.

If anything here is unclear or you'd like me to include extra snippets (example `hugo` commands, or a short developer checklist), tell me which section to expand and I will update. âœ…